---
import { getEntry } from "astro:content";
import Avatar from "./Avatar.astro";
import AppLink from "@components/AppLink.astro";
import PlusIcon from "icons:astro/heroicons/plus";

const {
  data: { person },
} = await getEntry("about", "about-me");
const { data } = await getEntry(person);

const me = {
  Name: data.name,
  Age: Math.floor((Date.now() - data.birthday.getTime()) / 31_556_952_000), // age in years
  From: data.from,
  Location: data.currentLocation,
  Experience: `${new Date().getFullYear() - data.industryStart} years`,
  Education: data.education,
} as const;
---

<div class="flex h-full w-full items-stretch justify-between">
  <div class="gradient basis-1/3 rounded-xl flex flex-col items-center">
    <Avatar image={data.avatar} class="mt-5 size-24 @lg:size-32" />
    <div class="mx-auto mt-5 max-w-fit max-h-fit rounded-full bg-background">
      <AppLink
        as="a"
        href="/lukas-trombach.vcf"
        download="lukas-trombach.vcf"
        class="text-center max-w-fit pl-3"
      >
        <PlusIcon />
        <span>Contact</span>
      </AppLink>
    </div>
  </div>
  <ul class="table mr-10 basis-2/3 py-5 @lg:py-10">
    {
      Object.entries(me).map(([key, value]) => (
        <li class="table-row">
          <span class="table-cell text-sm align-middle font-bold @lg:text-lg">
            {key}:
          </span>
          <span
            class="table-cell bg-background w-3/5 border-b border-t-0 border-x-0 border-dashed align-middle font-mono text-sm @lg:text-lg"
          >
            {value}
          </span>
        </li>
      ))
    }
  </ul>
</div>

<style>
  .gradient {
    --gradient-stop: 45%;

    @media screen(md) {
      --gradient-stop: 40%;
    }

    background-image: linear-gradient(
      to bottom right,
      theme(colors.primary.DEFAULT),
      theme(colors.primary.DEFAULT) var(--gradient-stop),
      transparent var(--gradient-stop)
    );
  }
</style>
